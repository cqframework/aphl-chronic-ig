{
  "resourceType": "Library",
  "id": "AlphoraCommon",
  "contained": [ {
    "resourceType": "Parameters",
    "id": "options",
    "parameter": [ {
      "name": "translatorVersion",
      "valueString": "3.11.0"
    }, {
      "name": "option",
      "valueString": "EnableLocators"
    }, {
      "name": "option",
      "valueString": "DisableListDemotion"
    }, {
      "name": "option",
      "valueString": "DisableListPromotion"
    }, {
      "name": "format",
      "valueString": "XML"
    }, {
      "name": "format",
      "valueString": "JSON"
    }, {
      "name": "analyzeDataRequirements",
      "valueBoolean": false
    }, {
      "name": "collapseDataRequirements",
      "valueBoolean": true
    }, {
      "name": "compatibilityLevel",
      "valueString": "1.5"
    }, {
      "name": "enableCqlOnly",
      "valueBoolean": false
    }, {
      "name": "errorLevel",
      "valueString": "Info"
    }, {
      "name": "signatureLevel",
      "valueString": "None"
    }, {
      "name": "validateUnits",
      "valueBoolean": true
    }, {
      "name": "verifyOnly",
      "valueBoolean": false
    } ]
  } ],
  "extension": [ {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-softwaresystem",
    "valueReference": {
      "reference": "Device/cqf-tooling"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-cqlOptions",
    "valueReference": {
      "reference": "#options"
    }
  } ],
  "url": "http://fhir.org/guides/cqf/aphl/chronic-ds/Library/AlphoraCommon",
  "name": "AlphoraCommon",
  "type": {
    "coding": [ {
      "system": "http://terminology.hl7.org/CodeSystem/library-type",
      "code": "logic-library"
    } ]
  },
  "relatedArtifact": [ {
    "type": "depends-on",
    "display": "FHIR model information",
    "resource": "http://fhir.org/guides/cqf/common/Library/FHIR-ModelInfo|4.0.1"
  }, {
    "type": "depends-on",
    "display": "Library FHIRHelpers",
    "resource": "http://fhir.org/guides/cqf/aphl/chronic-ds/Library/FHIRHelpers|4.1.000"
  }, {
    "type": "depends-on",
    "display": "Library FC",
    "resource": "http://fhir.org/guides/cqf/aphl/chronic-ds/Library/FHIRCommon|1.1.000"
  }, {
    "type": "depends-on",
    "display": "Code system ObservationCategoryCodes",
    "resource": "http://terminology.hl7.org/CodeSystem/observation-category"
  }, {
    "type": "depends-on",
    "display": "Code system ConditionClinicalStatusCodes",
    "resource": "http://terminology.hl7.org/CodeSystem/condition-clinical"
  }, {
    "type": "depends-on",
    "display": "Code system ConditionVerificationStatusCodes",
    "resource": "http://terminology.hl7.org/CodeSystem/condition-ver-status"
  }, {
    "type": "depends-on",
    "display": "Code system AllergyIntoleranceClinicalStatusCodes",
    "resource": "http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical"
  }, {
    "type": "depends-on",
    "display": "Code system AllergyIntoleranceVerificationStatusCodes",
    "resource": "http://terminology.hl7.org/CodeSystem/allergyintolerance-verification"
  } ],
  "parameter": [ {
    "name": "Patient",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Patient"
  } ],
  "dataRequirement": [ {
    "type": "Patient",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Patient" ]
  } ],
  "content": [ {
    "contentType": "text/cql",
    "data": "bGlicmFyeSBBbHBob3JhQ29tbW9uDQoNCnVzaW5nIEZISVIgdmVyc2lvbiAnNC4wLjEnDQoNCmluY2x1ZGUgRkhJUkhlbHBlcnMgdmVyc2lvbiAnNC4xLjAwMCcgY2FsbGVkIEZISVJIZWxwZXJzDQppbmNsdWRlIEZISVJDb21tb24gdmVyc2lvbiAnMS4xLjAwMCcgY2FsbGVkIEZDIA0KDQpjb2Rlc3lzdGVtICJPYnNlcnZhdGlvbkNhdGVnb3J5Q29kZXMiOiAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9vYnNlcnZhdGlvbi1jYXRlZ29yeScNCmNvZGVzeXN0ZW0gIkNvbmRpdGlvbkNsaW5pY2FsU3RhdHVzQ29kZXMiOiAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9jb25kaXRpb24tY2xpbmljYWwnDQoNCmNvZGUgImxhYm9yYXRvcnkiOiAnbGFib3JhdG9yeScgZnJvbSAiT2JzZXJ2YXRpb25DYXRlZ29yeUNvZGVzIiBkaXNwbGF5ICdsYWJvcmF0b3J5Jw0KY29kZSAiZXhhbSI6ICdleGFtJyBmcm9tICJPYnNlcnZhdGlvbkNhdGVnb3J5Q29kZXMiIGRpc3BsYXkgJ2V4YW0nDQpjb2RlICJzdXJ2ZXkiOiAnc3VydmV5JyBmcm9tICJPYnNlcnZhdGlvbkNhdGVnb3J5Q29kZXMiIGRpc3BsYXkgJ3N1cnZleScNCmNvZGUgInZpdGFsLXNpZ25zIjogJ3ZpdGFsLXNpZ25zJyBmcm9tICJPYnNlcnZhdGlvbkNhdGVnb3J5Q29kZXMiIGRpc3BsYXkgJ3ZpdGFsLXNpZ25zJw0KY29kZSAiYWN0aXZlIjogJ2FjdGl2ZScgZnJvbSAiQ29uZGl0aW9uQ2xpbmljYWxTdGF0dXNDb2RlcyINCg0KY29udGV4dCBQYXRpZW50DQoNCmRlZmluZSBmdW5jdGlvbiBPZmZpY2lhbChpZGVudGlmaWVycyBMaXN0PElkZW50aWZpZXI+KToNCiAgc2luZ2xldG9uIGZyb20gKGlkZW50aWZpZXJzIEkgd2hlcmUgSS51c2UgPSAnb2ZmaWNpYWwnKQ0KDQpkZWZpbmUgZnVuY3Rpb24gT2ZmaWNpYWwobmFtZXMgTGlzdDxIdW1hbk5hbWU+KToNCiAgc2luZ2xldG9uIGZyb20gKG5hbWVzIE4gd2hlcmUgTi51c2UgPSAnb2ZmaWNpYWwnKQ0KDQpkZWZpbmUgZnVuY3Rpb24gT25seShvYnNlcnZhdGlvbnMgTGlzdDxPYnNlcnZhdGlvbj4pOg0KICBzaW5nbGV0b24gZnJvbSBvYnNlcnZhdGlvbnMNCg0KZGVmaW5lIGZ1bmN0aW9uIEVhcmxpZXN0KG9ic2VydmF0aW9ucyBMaXN0PE9ic2VydmF0aW9uPik6DQogIEZpcnN0KA0KICAgIG9ic2VydmF0aW9ucyBPDQogICAgICBzb3J0IGJ5IGlzc3VlZA0KICApDQoNCmRlZmluZSBmdW5jdGlvbiBMYXRlc3Qob2JzZXJ2YXRpb25zIExpc3Q8T2JzZXJ2YXRpb24+KToNCiAgTGFzdCgNCiAgICBvYnNlcnZhdGlvbnMgTw0KICAgICAgc29ydCBieSBlZmZlY3RpdmUNCiAgKQ0KDQpkZWZpbmUgZnVuY3Rpb24gTW9zdFJlY2VudChvYnNlcnZhdGlvbnMgTGlzdDxPYnNlcnZhdGlvbj4pOg0KICBMYXN0KA0KICAgIG9ic2VydmF0aW9ucyBPDQogICAgICBzb3J0IGJ5IHN0YXJ0IG9mIEZDLlRvSW50ZXJ2YWwoZWZmZWN0aXZlKQ0KICApDQoNCmRlZmluZSBmdW5jdGlvbiBNb3N0UmVjZW50KGVuY291bnRlcnMgTGlzdDxFbmNvdW50ZXI+KToNCiAgTGFzdCgNCiAgICBlbmNvdW50ZXJzIE8NCiAgICAgIHNvcnQgYnkgc3RhcnQgb2YgcGVyaW9kDQogICkNCg0KZGVmaW5lIGZ1bmN0aW9uIE1vc3RSZWNlbnQoc2VydmljZXJlcXVlc3QgTGlzdDxTZXJ2aWNlUmVxdWVzdD4pOg0KICBMYXN0KA0KICAgIHNlcnZpY2VyZXF1ZXN0IE8NCiAgICAgIHNvcnQgYnkgYXV0aG9yZWRPbg0KICApDQoNCmRlZmluZSBmdW5jdGlvbiBNb3N0UmVjZW50KHByb2NlZHVyZXMgTGlzdDxQcm9jZWR1cmU+KToNCiAgTGFzdCgNCiAgICBwcm9jZWR1cmVzIE8NCiAgICAgIHNvcnQgYnkgKHBlcmZvcm1lZCBhcyBGSElSLmRhdGVUaW1lKQ0KICApDQoNCmRlZmluZSBmdW5jdGlvbiBMb3dlc3Qob2JzZXJ2YXRpb25zIExpc3Q8T2JzZXJ2YXRpb24+KToNCiAgRmlyc3QoDQogICAgb2JzZXJ2YXRpb25zIE8NCiAgICAgIHNvcnQgYnkgKHZhbHVlIGFzIEZISVIuUXVhbnRpdHkpDQogICkNCg0KZGVmaW5lIGZ1bmN0aW9uIEhpZ2hlc3Qob2JzZXJ2YXRpb25zIExpc3Q8T2JzZXJ2YXRpb24+KToNCiAgTGFzdCgNCiAgICBvYnNlcnZhdGlvbnMgTw0KICAgICAgc29ydCBieSAodmFsdWUgYXMgRkhJUi5RdWFudGl0eSkNCiAgKQ0KDQpkZWZpbmUgZnVuY3Rpb24gTWF4RGF0ZXMoYXNzZXNzbWVudHNEYXRlcyBMaXN0PEludGVydmFsPERhdGVUaW1lPj4pDQpyZXR1cm5zIEludGVydmFsPERhdGVUaW1lPjoNCiAgRmlyc3QoKA0KICAgIChhc3Nlc3NtZW50c0RhdGVzKSBBc3Nlc3NtZW50RGF0ZXMNCiAgICAgIHJldHVybiBUdXBsZXsgQXNzZXNzbWVudERhdGU6IEFzc2Vzc21lbnREYXRlc30NCiAgICApIFN0YXJ0RGF0ZQ0KICAgICAgc29ydCBieSBzdGFydCBvZiBBc3Nlc3NtZW50RGF0ZSBkZXNjZW5kaW5nDQogICkuQXNzZXNzbWVudERhdGUNCg0KZGVmaW5lIGZ1bmN0aW9uIE1heERhdGVzKGFzc2Vzc21lbnRzRGF0ZXMgTGlzdDxJbnRlcnZhbDxEYXRlPj4pDQpyZXR1cm5zIEludGVydmFsPERhdGU+Og0KICBGaXJzdCgoDQogICAgKGFzc2Vzc21lbnRzRGF0ZXMpIEFzc2Vzc21lbnREYXRlcw0KICAgICAgcmV0dXJuIFR1cGxleyBBc3Nlc3NtZW50RGF0ZTogQXNzZXNzbWVudERhdGVzfQ0KICAgICkgU3RhcnREYXRlDQogICAgICBzb3J0IGJ5IHN0YXJ0IG9mIEFzc2Vzc21lbnREYXRlIGRlc2NlbmRpbmcNCiAgKS5Bc3Nlc3NtZW50RGF0ZQ0KDQpkZWZpbmUgZnVuY3Rpb24gTWluRGF0ZXMoYXNzZXNzbWVudHNEYXRlcyBMaXN0PEludGVydmFsPERhdGVUaW1lPj4pDQpyZXR1cm5zIEludGVydmFsPERhdGVUaW1lPjoNCiAgRmlyc3QoKA0KICAgIChhc3Nlc3NtZW50c0RhdGVzKSBBc3Nlc3NtZW50RGF0ZXMNCiAgICAgIHdoZXJlIG5vdChzdGFydCBvZiBBc3Nlc3NtZW50RGF0ZXMgaXMgbnVsbCkNCiAgICAgIHJldHVybiBUdXBsZXsgQXNzZXNzbWVudERhdGU6IEFzc2Vzc21lbnREYXRlc30NCiAgICApIFN0YXJ0RGF0ZQ0KICAgICAgc29ydCBieSBzdGFydCBvZiBBc3Nlc3NtZW50RGF0ZSBhc2NlbmRpbmcNCiAgKS5Bc3Nlc3NtZW50RGF0ZQ0KDQpkZWZpbmUgZnVuY3Rpb24gR2V0SWQodXJpIFN0cmluZyk6DQoJTGFzdChTcGxpdCh1cmksICcvJykpDQoNCi8qZGVmaW5lIGZ1bmN0aW9uIEdldElkKHVyaSBMaXN0PFN0cmluZz4pOg0KICB1cmkgdXJpDQoJIHJldHVybiBHZXRJZCh1cmkpDQoqLw0KZGVmaW5lIGZ1bmN0aW9uIEdldElkTGlzdChsaXN0IExpc3Q8U3RyaW5nPik6DQogIGxpc3QgdXJpDQoJIHJldHVybiBMYXN0KFNwbGl0KHVyaSwgJy8nKSkNCg0KIC8qDQpAZGVzY3JpcHRpb246IHZlcmlmaWVzIHRoYXQgcXVhbnRpdHkgdHlwZXMgaGF2ZSB0aGUgZ2l2ZW4gdW5pdC4NCkBjb21tZW50OiBOT1RFOiBUaGlzIGZ1bmN0aW9uIGV2YWx1YXRlcyBjb3JyZWN0bHkgaW4gdGhlIGNxbC1sYW5ndWFnZSBwbHVnaW4gYXMgb2YgMi4xMC4xIGJ1dCBub3QgaW4gdGhlIGNxbC10b29saW5nIHRyYXNsYXRvciBhcyBvZiA5LzIwLzIxDQoqLw0KLyogZGVmaW5lIGZ1bmN0aW9uIFdpdGhVbml0KHZhbHVlIEZISVIuUXVhbnRpdHksIHVuaXQgU3RyaW5nKToNCiAgICgNCiAgICAgdmFsdWUgcXVhbnRpdHkNCiAgICAgd2hlcmUgKA0KICAgICAgIHF1YW50aXR5LmNvZGUudmFsdWUgfiB1bml0DQogICAgICAgb3IgcXVhbnRpdHkudW5pdC52YWx1ZSB+IHVuaXQNCiAgICAgKQ0KICAgKSBpcyBub3QgbnVsbA0KKi8NCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyBhbnkgQWxwaG9yYSBleHRlbnNpb25zIGRlZmluZWQgb24gdGhlIGdpdmVuIHJlc291cmNlIHdpdGggdGhlIHNwZWNpZmllZCBpZC4NCkBjb21tZW50OiBOT1RFOiBFeHRlbnNpb25zIGFyZSBub3QgdGhlIHByZWZlcnJlZCBhcHByb2FjaCwgYnV0IGFyZSB1c2VkIGFzIGEgd2F5IHRvIGFjY2Vzcw0KY29udGVudCB0aGF0IGlzIGRlZmluZWQgYnkgZXh0ZW5zaW9ucyBidXQgbm90IHlldCBzdXJmYWNlZCBpbiB0aGUNCkNRTCBtb2RlbCBpbmZvLg0KKi8NCmRlZmluZSBmdW5jdGlvbiBFeHRlbnNpb25zKGRvbWFpblJlc291cmNlIERvbWFpblJlc291cmNlLCBpZCBTdHJpbmcpOg0KICBkb21haW5SZXNvdXJjZS5leHRlbnNpb24gRQ0KCSAgd2hlcmUgRS51cmwgPSAoJ2h0dHA6Ly9jb250ZW50LmFscGhvcmEuY29tL2ZoaXIvZHFtJyArIGlkKQ0KCQlyZXR1cm4gRQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIHRoZSBzaW5nbGUgQWxwaG9yYSBleHRlbnNpb24gKGlmIHByZXNlbnQpIG9uIHRoZSBnaXZlbiByZXNvdXJjZSB3aXRoIHRoZSBzcGVjaWZpZWQgaWQuDQpAY29tbWVudDogVGhpcyBmdW5jdGlvbiB1c2VzIHNpbmdsZXRvbiBmcm9tIHRvIGVuc3VyZSB0aGF0IGEgcnVuLXRpbWUgZXhjZXB0aW9uIGlzIHRocm93biBpZiB0aGVyZQ0KaXMgbW9yZSB0aGFuIG9uZSBleHRlbnNpb24gb24gdGhlIGdpdmVuIHJlc291cmNlIHdpdGggdGhlIHNwZWNpZmllZCBpZC4NCiovDQpkZWZpbmUgZnVuY3Rpb24gRXh0ZW5zaW9uKGRvbWFpblJlc291cmNlIERvbWFpblJlc291cmNlLCBpZCBTdHJpbmcpOg0KICBzaW5nbGV0b24gZnJvbSAiRXh0ZW5zaW9ucyIoZG9tYWluUmVzb3VyY2UsIGlkKQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIGFueSBBbHBob3JhIGV4dGVuc2lvbnMgZGVmaW5lZCBvbiB0aGUgZ2l2ZW4gZWxlbWVudCB3aXRoIHRoZSBzcGVjaWZpZWQgaWQuDQpAY29tbWVudDogTk9URTogRXh0ZW5zaW9ucyBhcmUgbm90IHRoZSBwcmVmZXJyZWQgYXBwcm9hY2gsIGJ1dCBhcmUgdXNlZCBhcyBhIHdheSB0byBhY2Nlc3MNCmNvbnRlbnQgdGhhdCBpcyBkZWZpbmVkIGJ5IGV4dGVuc2lvbnMgYnV0IG5vdCB5ZXQgc3VyZmFjZWQgaW4gdGhlIENRTCBtb2RlbCBpbmZvLg0KKi8NCmRlZmluZSBmdW5jdGlvbiBFeHRlbnNpb25zKGVsZW1lbnQgRWxlbWVudCwgaWQgU3RyaW5nKToNCiAgZWxlbWVudC5leHRlbnNpb24gRQ0KCSAgd2hlcmUgRS51cmwgPSAoJ2h0dHA6Ly9jb250ZW50LmFscGhvcmEuY29tL2ZoaXIvZHFtJyArIGlkKQ0KCQlyZXR1cm4gRQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIHRoZSBzaW5nbGUgQWxwaG9yYSBleHRlbnNpb24gKGlmIHByZXNlbnQpIG9uIHRoZSBnaXZlbiBlbGVtZW50IHdpdGggdGhlIHNwZWNpZmllZCBpZC4NCkBjb21tZW50OiBUaGlzIGZ1bmN0aW9uIHVzZXMgc2luZ2xldG9uIGZyb20gdG8gZW5zdXJlIHRoYXQgYSBydW4tdGltZSBleGNlcHRpb24gaXMgdGhyb3duIGlmIHRoZXJlDQppcyBtb3JlIHRoYW4gb25lIGV4dGVuc2lvbiBvbiB0aGUgZ2l2ZW4gcmVzb3VyY2Ugd2l0aCB0aGUgc3BlY2lmaWVkIHVybC4NCiovDQpkZWZpbmUgZnVuY3Rpb24gRXh0ZW5zaW9uKGVsZW1lbnQgRWxlbWVudCwgaWQgU3RyaW5nKToNCiAgc2luZ2xldG9uIGZyb20gRXh0ZW5zaW9ucyhlbGVtZW50LCBpZCkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyBhbnkgQWxwaG9yYSBtb2RpZmllciBleHRlbnNpb25zIGRlZmluZWQgb24gdGhlIGdpdmVuIHJlc291cmNlIHdpdGggdGhlIHNwZWNpZmllZCBpZC4NCkBjb21tZW50OiBOT1RFOiBFeHRlbnNpb25zIGFyZSBub3QgdGhlIHByZWZlcnJlZCBhcHByb2FjaCwgYnV0IGFyZSB1c2VkIGFzIGEgd2F5IHRvIGFjY2Vzcw0KY29udGVudCB0aGF0IGlzIGRlZmluZWQgYnkgZXh0ZW5zaW9ucyBidXQgbm90IHlldCBzdXJmYWNlZCBpbiB0aGUNCkNRTCBtb2RlbCBpbmZvLg0KKi8NCmRlZmluZSBmdW5jdGlvbiBNb2RpZmllckV4dGVuc2lvbnMoZG9tYWluUmVzb3VyY2UgRG9tYWluUmVzb3VyY2UsIGlkIFN0cmluZyk6DQogIGRvbWFpblJlc291cmNlLm1vZGlmaWVyRXh0ZW5zaW9uIEUNCgkgIHdoZXJlIEUudXJsID0gKCdodHRwOi8vY29udGVudC5hbHBob3JhLmNvbS9maGlyL2RxbScgKyBpZCkNCgkJcmV0dXJuIEUNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0aGUgc2luZ2xlIEFscGhvcmEgbW9kaWZpZXIgZXh0ZW5zaW9uIChpZiBwcmVzZW50KSBvbiB0aGUgZ2l2ZW4gcmVzb3VyY2Ugd2l0aCB0aGUgc3BlY2lmaWVkIGlkLg0KQGNvbW1lbnQ6IFRoaXMgZnVuY3Rpb24gdXNlcyBzaW5nbGV0b24gZnJvbSB0byBlbnN1cmUgdGhhdCBhIHJ1bi10aW1lIGV4Y2VwdGlvbiBpcyB0aHJvd24gaWYgdGhlcmUNCmlzIG1vcmUgdGhhbiBvbmUgZXh0ZW5zaW9uIG9uIHRoZSBnaXZlbiByZXNvdXJjZSB3aXRoIHRoZSBzcGVjaWZpZWQgdXJsLg0KKi8NCmRlZmluZSBmdW5jdGlvbiBNb2RpZmllckV4dGVuc2lvbihkb21haW5SZXNvdXJjZSBEb21haW5SZXNvdXJjZSwgaWQgU3RyaW5nKToNCiAgc2luZ2xldG9uIGZyb20gTW9kaWZpZXJFeHRlbnNpb25zKGRvbWFpblJlc291cmNlLCBpZCkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyBhbnkgQWxwaG9yYSBtb2RpZmllciBleHRlbnNpb25zIGRlZmluZWQgb24gdGhlIGdpdmVuIGVsZW1lbnQgd2l0aCB0aGUgc3BlY2lmaWVkIGlkLg0KQGNvbW1lbnQ6IE5PVEU6IEV4dGVuc2lvbnMgYXJlIG5vdCB0aGUgcHJlZmVycmVkIGFwcHJvYWNoLCBidXQgYXJlIHVzZWQgYXMgYSB3YXkgdG8gYWNjZXNzDQpjb250ZW50IHRoYXQgaXMgZGVmaW5lZCBieSBleHRlbnNpb25zIGJ1dCBub3QgeWV0IHN1cmZhY2VkIGluIHRoZSBDUUwgbW9kZWwgaW5mby4NCiovDQpkZWZpbmUgZnVuY3Rpb24gTW9kaWZpZXJFeHRlbnNpb25zKGVsZW1lbnQgQmFja2JvbmVFbGVtZW50LCBpZCBTdHJpbmcpOg0KICBlbGVtZW50Lm1vZGlmaWVyRXh0ZW5zaW9uIEUNCgkgIHdoZXJlIEUudXJsID0gKCdodHRwOi8vY29udGVudC5hbHBob3JhLmNvbS9maGlyL2RxbScgKyBpZCkNCgkJcmV0dXJuIEUNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0aGUgc2luZ2xlIEFscGhvcmEgbW9kaWZpZXIgZXh0ZW5zaW9uIChpZiBwcmVzZW50KSBvbiB0aGUgZ2l2ZW4gZWxlbWVudCB3aXRoIHRoZSBzcGVjaWZpZWQgaWQuDQpAY29tbWVudDogVGhpcyBmdW5jdGlvbiB1c2VzIHNpbmdsZXRvbiBmcm9tIHRvIGVuc3VyZSB0aGF0IGEgcnVuLXRpbWUgZXhjZXB0aW9uIGlzIHRocm93biBpZiB0aGVyZQ0KaXMgbW9yZSB0aGFuIG9uZSBleHRlbnNpb24gb24gdGhlIGdpdmVuIHJlc291cmNlIHdpdGggdGhlIHNwZWNpZmllZCB1cmwuDQoqLw0KZGVmaW5lIGZ1bmN0aW9uIE1vZGlmaWVyRXh0ZW5zaW9uKGVsZW1lbnQgQmFja2JvbmVFbGVtZW50LCBpZCBTdHJpbmcpOg0KICBzaW5nbGV0b24gZnJvbSBNb2RpZmllckV4dGVuc2lvbnMoZWxlbWVudCwgaWQpDQoNCg0KLyogUUktQ09SRSBFeHRlbnNpb25zICovDQoNCi8qDQpOT1RFOiBFeHRlbnNpb25zIGFyZSBub3QgdGhlIHByZWZlcnJlZCBhcHByb2FjaCwgYnV0IGFyZSB1c2VkIGFzIGEgd2F5IHRvIGFjY2Vzcw0KY29udGVudCB0aGF0IGlzIGRlZmluZWQgYnkgZXh0ZW5zaW9ucyBidXQgbm90IHlldCBzdXJmYWNlZCBpbiB0aGUNCkNRTCBtb2RlbCBpbmZvLg0KKi8NCmRlZmluZSBmdW5jdGlvbiBRSUNvcmVNb2RpZmllckV4dGVuc2lvbnMoZG9tYWluUmVzb3VyY2UgRG9tYWluUmVzb3VyY2UsIHVybCBTdHJpbmcpOg0KICBkb21haW5SZXNvdXJjZS5tb2RpZmllckV4dGVuc2lvbiBFDQogICAgd2hlcmUgRS51cmwgPSAoJ2h0dHA6Ly9obDcub3JnL2ZoaXIvdXMvcWljb3JlL1N0cnVjdHVyZURlZmluaXRpb24vJyArIHVybCkNCiAgICByZXR1cm4gRQ0KDQpkZWZpbmUgZnVuY3Rpb24gUUlDb3JlTW9kaWZpZXJFeHRlbnNpb24oZG9tYWluUmVzb3VyY2UgRG9tYWluUmVzb3VyY2UsIHVybCBTdHJpbmcpOg0KICBzaW5nbGV0b24gZnJvbSBRSUNvcmVNb2RpZmllckV4dGVuc2lvbnMoZG9tYWluUmVzb3VyY2UsIHVybCkNCg0KZGVmaW5lIGZ1bmN0aW9uIFFJQ29yZUV4dGVuc2lvbnMoZG9tYWluUmVzb3VyY2UgRG9tYWluUmVzb3VyY2UsIHVybCBTdHJpbmcpOg0KICBkb21haW5SZXNvdXJjZS5leHRlbnNpb24gRQ0KICAgIHdoZXJlIEUudXJsID0gKCdodHRwOi8vaGw3Lm9yZy9maGlyL3VzL3FpY29yZS9TdHJ1Y3R1cmVEZWZpbml0aW9uLycgKyB1cmwpDQogICAgcmV0dXJuIEUNCg0KZGVmaW5lIGZ1bmN0aW9uIFFJQ29yZUV4dGVuc2lvbihkb21haW5SZXNvdXJjZSBEb21haW5SZXNvdXJjZSwgdXJsIFN0cmluZyk6DQogIHNpbmdsZXRvbiBmcm9tIFFJQ29yZUV4dGVuc2lvbnMoZG9tYWluUmVzb3VyY2UsIHVybCkNCg0KZGVmaW5lIGZ1bmN0aW9uIEdldEJhc2VNb2RpZmllckV4dGVuc2lvbnMoZG9tYWluUmVzb3VyY2UgRG9tYWluUmVzb3VyY2UsIHVybCBTdHJpbmcpOg0KICBkb21haW5SZXNvdXJjZS5tb2RpZmllckV4dGVuc2lvbiBFDQoJICB3aGVyZSBFLnVybCA9ICgnaHR0cDovL2hsNy5vcmcvZmhpci9TdHJ1Y3R1cmVEZWZpbml0aW9uLycgKyB1cmwpDQoJCXJldHVybiBFDQoNCmRlZmluZSBmdW5jdGlvbiBHZXRCYXNlTW9kaWZpZXJFeHRlbnNpb24oZG9tYWluUmVzb3VyY2UgRG9tYWluUmVzb3VyY2UsIHVybCBTdHJpbmcpOg0KICBzaW5nbGV0b24gZnJvbSBHZXRCYXNlTW9kaWZpZXJFeHRlbnNpb25zKGRvbWFpblJlc291cmNlLCB1cmwpDQoNCmRlZmluZSBmdW5jdGlvbiBHZXRCYXNlRXh0ZW5zaW9ucyhkb21haW5SZXNvdXJjZSBEb21haW5SZXNvdXJjZSwgdXJsIFN0cmluZyk6DQogIGRvbWFpblJlc291cmNlLmV4dGVuc2lvbiBFDQoJICB3aGVyZSBFLnVybCA9ICgnaHR0cDovL2hsNy5vcmcvZmhpci9TdHJ1Y3R1cmVEZWZpbml0aW9uLycgKyB1cmwpDQoJCXJldHVybiBFDQoNCmRlZmluZSBmdW5jdGlvbiBHZXRCYXNlRXh0ZW5zaW9uKGRvbWFpblJlc291cmNlIERvbWFpblJlc291cmNlLCB1cmwgU3RyaW5nKToNCiAgc2luZ2xldG9uIGZyb20gR2V0QmFzZUV4dGVuc2lvbnMoZG9tYWluUmVzb3VyY2UsIHVybCkNCg0KZGVmaW5lIGZ1bmN0aW9uIEdldFVTTW9kaWZpZXJFeHRlbnNpb25zKGRvbWFpblJlc291cmNlIERvbWFpblJlc291cmNlLCB1cmwgU3RyaW5nKToNCiAgZG9tYWluUmVzb3VyY2UubW9kaWZpZXJFeHRlbnNpb24gRQ0KCSAgd2hlcmUgRS51cmwgPSAoJ2h0dHA6Ly9obDcub3JnL2ZoaXIvdXMvY29yZS9TdHJ1Y3R1cmVEZWZpbml0aW9uLycgKyB1cmwpDQoJCXJldHVybiBFDQoNCmRlZmluZSBmdW5jdGlvbiBHZXRVU01vZGlmaWVyRXh0ZW5zaW9uKGRvbWFpblJlc291cmNlIERvbWFpblJlc291cmNlLCB1cmwgU3RyaW5nKToNCiAgc2luZ2xldG9uIGZyb20gR2V0VVNNb2RpZmllckV4dGVuc2lvbnMoZG9tYWluUmVzb3VyY2UsIHVybCkNCg0KZGVmaW5lIGZ1bmN0aW9uIEdldFVTRXh0ZW5zaW9ucyhkb21haW5SZXNvdXJjZSBEb21haW5SZXNvdXJjZSwgdXJsIFN0cmluZyk6DQogIGRvbWFpblJlc291cmNlLmV4dGVuc2lvbiBFDQoJICB3aGVyZSBFLnVybCA9ICgnaHR0cDovL2hsNy5vcmcvZmhpci91cy9jb3JlL1N0cnVjdHVyZURlZmluaXRpb24vJyArIHVybCkNCgkJcmV0dXJuIEUNCg0KZGVmaW5lIGZ1bmN0aW9uIEdldFVTRXh0ZW5zaW9uKGRvbWFpblJlc291cmNlIERvbWFpblJlc291cmNlLCB1cmwgU3RyaW5nKToNCiAgc2luZ2xldG9uIGZyb20gR2V0VVNFeHRlbnNpb25zKGRvbWFpblJlc291cmNlLCB1cmwpDQoNCmRlZmluZSBmdW5jdGlvbiBHZXRFeHRlbnNpb25WYWx1ZShleHRlbnNpb24gRXh0ZW5zaW9uKToNCiAgZXh0ZW5zaW9uLnZhbHVlLnZhbHVlDQoNCmRlZmluZSBmdW5jdGlvbiBSZXNvdXJjZU5vdERvbmUobm90RG9uZSBEb21haW5SZXNvdXJjZSk6DQogIFFJQ29yZU1vZGlmaWVyRXh0ZW5zaW9uKG5vdERvbmUsICdxaWNvcmUtbm90RG9uZScpDQoNCmRlZmluZSBmdW5jdGlvbiBSZXNvdXJjZU5vdERvbmVSZWFzb24obm90RG9uZVJlYXNvbiBEb21haW5SZXNvdXJjZSk6DQogIFFJQ29yZUV4dGVuc2lvbihub3REb25lUmVhc29uLCAncWljb3JlLW5vdERvbmVSZWFzb24nKQ0KDQpkZWZpbmUgZnVuY3Rpb24gUmVzb3VyY2VOb3REb25lUmVhc29uKGNob2ljZSBDaG9pY2U8RkhJUi5Db21tdW5pY2F0aW9uLCBGSElSLkltbXVuaXphdGlvbiwgRkhJUi5NZWRpY2F0aW9uQWRtaW5pc3RyYXRpb24sIEZISVIuTWVkaWNhdGlvbkRpc3BlbnNlLCBGSElSLk1lZGljYXRpb25SZXF1ZXN0LCBGSElSLk9ic2VydmF0aW9uLCBGSElSLlByb2NlZHVyZSwgRkhJUi5TZXJ2aWNlUmVxdWVzdD4pOg0KICBjYXNlDQogICAgd2hlbiBjaG9pY2UgaXMgRkhJUi5PYnNlcnZhdGlvbiB0aGVuDQogICAgICBSZXNvdXJjZU5vdERvbmVSZWFzb24oY2hvaWNlIGFzIEZISVIuT2JzZXJ2YXRpb24pDQogICAgd2hlbiBjaG9pY2UgaXMgRkhJUi5TZXJ2aWNlUmVxdWVzdCB0aGVuDQogICAgICBSZXNvdXJjZURvTm90UGVyZm9ybVJlYXNvbihjaG9pY2UgYXMgRkhJUi5TZXJ2aWNlUmVxdWVzdCkNCiAgICBlbHNlIG51bGwNCiAgZW5kDQoNCmRlZmluZSBmdW5jdGlvbiBSZXNvdXJjZURvTm90UGVyZm9ybVJlYXNvbihkb05vdFBlcmZvcm1SZWFzb24gRG9tYWluUmVzb3VyY2UpOg0KICBRSUNvcmVFeHRlbnNpb24oZG9Ob3RQZXJmb3JtUmVhc29uLCAncWljb3JlLWRvTm90UGVyZm9ybVJlYXNvbicpIA0KDQpkZWZpbmUgZnVuY3Rpb24gUmVzb3VyY2VOb3REb25lUmVjb3JkZWQocmVjb3JkZWQgRG9tYWluUmVzb3VyY2UpOg0KICBRSUNvcmVFeHRlbnNpb24ocmVjb3JkZWQsICdxaWNvcmUtcmVjb3JkZWQnKQ0KDQpkZWZpbmUgZnVuY3Rpb24gUmVzb3VyY2VOb3REb25lUmVjb3JkZWQoY2hvaWNlIENob2ljZTxGSElSLkNvbW11bmljYXRpb24sIEZISVIuSW1tdW5pemF0aW9uLCBGSElSLk1lZGljYXRpb25BZG1pbmlzdHJhdGlvbiwgRkhJUi5NZWRpY2F0aW9uRGlzcGVuc2UsIEZISVIuTWVkaWNhdGlvblJlcXVlc3QsIEZISVIuT2JzZXJ2YXRpb24sIEZISVIuUHJvY2VkdXJlLCBGSElSLlNlcnZpY2VSZXF1ZXN0Pik6DQogIGNhc2UNCiAgICB3aGVuIGNob2ljZSBpcyBGSElSLkNvbW11bmljYXRpb24gdGhlbg0KICAgICAgUUlDb3JlRXh0ZW5zaW9uKGNob2ljZSBhcyBGSElSLkNvbW11bmljYXRpb24sICdxaWNvcmUtcmVjb3JkZWQnKQ0KICAgIHdoZW4gY2hvaWNlIGlzIEZISVIuTWVkaWNhdGlvbkFkbWluaXN0cmF0aW9uIHRoZW4NCiAgICAgIFFJQ29yZUV4dGVuc2lvbihjaG9pY2UgYXMgRkhJUi5NZWRpY2F0aW9uQWRtaW5pc3RyYXRpb24sICdxaWNvcmUtcmVjb3JkZWQnKQ0KICAgIHdoZW4gY2hvaWNlIGlzIEZISVIuTWVkaWNhdGlvbkRpc3BlbnNlIHRoZW4NCiAgICAgIFFJQ29yZUV4dGVuc2lvbihjaG9pY2UgYXMgRkhJUi5NZWRpY2F0aW9uRGlzcGVuc2UsICdxaWNvcmUtcmVjb3JkZWQnKQ0KICAgIHdoZW4gY2hvaWNlIGlzIEZISVIuUHJvY2VkdXJlIHRoZW4NCiAgICAgIFFJQ29yZUV4dGVuc2lvbihjaG9pY2UgYXMgRkhJUi5Qcm9jZWR1cmUsICdxaWNvcmUtcmVjb3JkZWQnKQ0KICAgIGVsc2UgbnVsbA0KICBlbmQNCg0KZGVmaW5lIGZ1bmN0aW9uIE5vdERvbmVWYWx1ZVNldChjaG9pY2UgQ2hvaWNlPEZISVIuQ29tbXVuaWNhdGlvbiwgRkhJUi5EZXZpY2VSZXF1ZXN0LCBGSElSLkltbXVuaXphdGlvbiwgRkhJUi5NZWRpY2F0aW9uQWRtaW5pc3RyYXRpb24sIEZISVIuTWVkaWNhdGlvbkRpc3BlbnNlLCBGSElSLk1lZGljYXRpb25SZXF1ZXN0LA0KICAgRkhJUi5PYnNlcnZhdGlvbiwgRkhJUi5Qcm9jZWR1cmUsIEZISVIuU2VydmljZVJlcXVlc3Q+KToNCiAgY2FzZQ0KICAgIHdoZW4gY2hvaWNlIGlzIEZISVIuQ29tbXVuaWNhdGlvbiB0aGVuDQogICAgICBHZXRFeHRlbnNpb25WYWx1ZSgNCiAgICAgICAgc2luZ2xldG9uIGZyb20gKGNob2ljZS5yZWFzb25Db2RlLmNvZGluZy5leHRlbnNpb24gRQ0KICAgICAgICAgIHdoZXJlIEUudXJsID0gKCdodHRwOi8vaGw3Lm9yZy9maGlyL1N0cnVjdHVyZURlZmluaXRpb24vdmFsdWVzZXQtcmVmZXJlbmNlJykNCiAgICAgICkpDQogICAgd2hlbiBjaG9pY2UgaXMgRkhJUi5EZXZpY2VSZXF1ZXN0IHRoZW4NCiAgICAgIEdldEV4dGVuc2lvblZhbHVlKA0KICAgICAgICBzaW5nbGV0b24gZnJvbSAoY2hvaWNlLmNvZGUuY29kaW5nLmV4dGVuc2lvbiBFDQogICAgICAgICAgd2hlcmUgRS51cmwgPSAoJ2h0dHA6Ly9obDcub3JnL2ZoaXIvU3RydWN0dXJlRGVmaW5pdGlvbi92YWx1ZXNldC1yZWZlcmVuY2UnKQ0KICAgICAgKSkNCiAgICB3aGVuIGNob2ljZSBpcyBGSElSLkltbXVuaXphdGlvbiB0aGVuDQogICAgICBHZXRFeHRlbnNpb25WYWx1ZSgNCiAgICAgICAgc2luZ2xldG9uIGZyb20gKGNob2ljZS52YWNjaW5lQ29kZS5jb2RpbmcuZXh0ZW5zaW9uIEUNCiAgICAgICAgICB3aGVyZSBFLnVybCA9ICgnaHR0cDovL2hsNy5vcmcvZmhpci9TdHJ1Y3R1cmVEZWZpbml0aW9uL3ZhbHVlc2V0LXJlZmVyZW5jZScpDQogICAgICApKQ0KICAgIHdoZW4gY2hvaWNlIGlzIEZISVIuTWVkaWNhdGlvbkFkbWluaXN0cmF0aW9uIHRoZW4NCiAgICAgIEdldEV4dGVuc2lvblZhbHVlKA0KICAgICAgICBzaW5nbGV0b24gZnJvbSAoY2hvaWNlLm1lZGljYXRpb24uY29kaW5nLmV4dGVuc2lvbiBFDQogICAgICAgICAgd2hlcmUgRS51cmwgPSAoJ2h0dHA6Ly9obDcub3JnL2ZoaXIvU3RydWN0dXJlRGVmaW5pdGlvbi92YWx1ZXNldC1yZWZlcmVuY2UnKQ0KICAgICAgKSkNCiAgICB3aGVuIGNob2ljZSBpcyBGSElSLk1lZGljYXRpb25EaXNwZW5zZSB0aGVuDQogICAgICBHZXRFeHRlbnNpb25WYWx1ZSgNCiAgICAgICAgc2luZ2xldG9uIGZyb20gKGNob2ljZS5tZWRpY2F0aW9uLmNvZGluZy5leHRlbnNpb24gRQ0KICAgICAgICAgIHdoZXJlIEUudXJsID0gKCdodHRwOi8vaGw3Lm9yZy9maGlyL1N0cnVjdHVyZURlZmluaXRpb24vdmFsdWVzZXQtcmVmZXJlbmNlJykNCiAgICAgICkpDQogICAgd2hlbiBjaG9pY2UgaXMgRkhJUi5NZWRpY2F0aW9uUmVxdWVzdCB0aGVuDQogICAgICBHZXRFeHRlbnNpb25WYWx1ZSgNCiAgICAgICAgc2luZ2xldG9uIGZyb20gKGNob2ljZS5tZWRpY2F0aW9uLmNvZGluZy5leHRlbnNpb24gRQ0KICAgICAgICAgIHdoZXJlIEUudXJsID0gKCdodHRwOi8vaGw3Lm9yZy9maGlyL1N0cnVjdHVyZURlZmluaXRpb24vdmFsdWVzZXQtcmVmZXJlbmNlJykNCiAgICAgICkpDQogICAgd2hlbiBjaG9pY2UgaXMgRkhJUi5PYnNlcnZhdGlvbiB0aGVuDQogICAgICBHZXRFeHRlbnNpb25WYWx1ZSgNCiAgICAgICAgc2luZ2xldG9uIGZyb20gKGNob2ljZS5jb2RlLmNvZGluZy5leHRlbnNpb24gRQ0KICAgICAgICAgIHdoZXJlIEUudXJsID0gKCdodHRwOi8vaGw3Lm9yZy9maGlyL1N0cnVjdHVyZURlZmluaXRpb24vdmFsdWVzZXQtcmVmZXJlbmNlJykNCiAgICAgICkpDQogICAgd2hlbiBjaG9pY2UgaXMgRkhJUi5Qcm9jZWR1cmUgdGhlbg0KICAgICAgR2V0RXh0ZW5zaW9uVmFsdWUoDQogICAgICAgIHNpbmdsZXRvbiBmcm9tIChjaG9pY2UuY29kZS5jb2RpbmcuZXh0ZW5zaW9uIEUNCiAgICAgICAgICB3aGVyZSBFLnVybCA9ICgnaHR0cDovL2hsNy5vcmcvZmhpci9TdHJ1Y3R1cmVEZWZpbml0aW9uL3ZhbHVlc2V0LXJlZmVyZW5jZScpDQogICAgICApKQ0KICAgIHdoZW4gY2hvaWNlIGlzIEZISVIuU2VydmljZVJlcXVlc3QgdGhlbg0KICAgICAgR2V0RXh0ZW5zaW9uVmFsdWUoDQogICAgICAgIHNpbmdsZXRvbiBmcm9tIChjaG9pY2UuY29kZS5jb2RpbmcuZXh0ZW5zaW9uIEUNCiAgICAgICAgICB3aGVyZSBFLnVybCA9ICgnaHR0cDovL2hsNy5vcmcvZmhpci9TdHJ1Y3R1cmVEZWZpbml0aW9uL3ZhbHVlc2V0LXJlZmVyZW5jZScpDQogICAgICApKQ0KICAgIGVsc2UgbnVsbA0KICBlbmQNCg0KDQpkZWZpbmUgZnVuY3Rpb24gQWJzZW50RGF0YShvYnNlcnZhdGlvbiBMaXN0PEZISVIuT2JzZXJ2YXRpb24+LCBlbmMgTGlzdDxGSElSLkVuY291bnRlcj4sIGNvZGUxIFN5c3RlbS5Db2RlLCB2YWx1ZXNldDEgU3lzdGVtLlZhbHVlU2V0KQ0KcmV0dXJucyBMaXN0PEZISVIuT2JzZXJ2YXRpb24+Og0KICAoUXVhbGlmaWVkT2JzZXJ2YXRpb25zKG9ic2VydmF0aW9uKSkgT2JzDQogICAgd2l0aCBlbmMgUXVhbGlmeWluZ0VuYw0KICAgICAgc3VjaCB0aGF0IENvYWxlc2NlKGVuZCBvZiBGQy5Ub0ludGVydmFsKE9icy5lZmZlY3RpdmUpLCBlbmQgb2YgRkMuVG9JbnRlcnZhbChPYnMuaXNzdWVkKSkgc2FtZSBkYXkgYXMgZW5kIG9mIFF1YWxpZnlpbmdFbmMucGVyaW9kDQogICAgd2hlcmUgZXhpc3RzKA0KICAgICAgICBPYnMuY29tcG9uZW50IGMgd2hlcmUoDQogICAgICAgICAgICBjLmNvZGUgYXMgQ29kZWFibGVDb25jZXB0IH4gY29kZTENCiAgICAgICAgICAgIG9yIGMuY29kZSBhcyBDb2RlYWJsZUNvbmNlcHQgaW4gdmFsdWVzZXQxDQogICAgICAgICkpDQogICAgICBhbmQgbm90IGV4aXN0cyhPYnMuY29tcG9uZW50IGMgd2hlcmUoYy52YWx1ZSBpcyBub3QgbnVsbCkpDQogICAgICBvciAoUmVzb3VyY2VOb3REb25lKE9icykudmFsdWUgYXMgRkhJUi5ib29sZWFuID0gdHJ1ZQ0KICAgICAgICBhbmQgKFJlc291cmNlTm90RG9uZVJlYXNvbihPYnMpLnZhbHVlIGFzIENvZGVhYmxlQ29uY2VwdCB+IGNvZGUxDQogICAgICAgIG9yIFJlc291cmNlTm90RG9uZVJlYXNvbihPYnMpLnZhbHVlIGFzIENvZGVhYmxlQ29uY2VwdCBpbiB2YWx1ZXNldDEpKQ0KDQovKiBDb21tb24gUmVzb3VyY2UgUXVhbGlmaWNhdGlvbnMgYW5kIE5lZ2F0aW9ucyAqLw0KZGVmaW5lIGZ1bmN0aW9uIFF1YWxpZmllZEVuY291bnRlcnModmFsdWUgTGlzdDxGSElSLkVuY291bnRlcj4pOg0KICB2YWx1ZSBFbmNvdW50ZXINCiAgICB3aGVyZSAoDQogICAgICAvL3BsYW5uZWQgfCBhcnJpdmVkIHwgdHJpYWdlZCB8IGluLXByb2dyZXNzIHwgb25sZWF2ZSB8IGZpbmlzaGVkIHwgY2FuY2VsbGVkIHwgZW50ZXJlZC1pbi1lcnJvciB8IHVua25vd24NCiAgICAgIEVuY291bnRlci5zdGF0dXMgfiAnYXJyaXZlZCcNCiAgICAgIG9yIEVuY291bnRlci5zdGF0dXMgfiAnaW4tcHJvZ3Jlc3MnDQogICAgICBvciBFbmNvdW50ZXIuc3RhdHVzIH4gJ2ZpbmlzaGVkJw0KICAgICAgb3IgRW5jb3VudGVyLnN0YXR1cyB+ICdvbmxlYXZlJw0KICAgICAgb3IgRW5jb3VudGVyLnN0YXR1cyB+ICd0cmlhZ2VkJw0KICAgICkNCg0KZGVmaW5lIGZ1bmN0aW9uIFF1YWxpZmllZENvbmRpdGlvbnModmFsdWUgTGlzdDxGSElSLkNvbmRpdGlvbj4pOg0KICB2YWx1ZSBDb25kaXRpb24NCiAgICB3aGVyZSAoDQogICAgICBGSElSSGVscGVycy5Ub0NvbmNlcHQoQ29uZGl0aW9uLmNsaW5pY2FsU3RhdHVzKSB+IEZDLiJhY3RpdmUiDQogICAgKQ0KICAgIGFuZCAoDQogICAgICBGSElSSGVscGVycy5Ub0NvbmNlcHQoQ29uZGl0aW9uLnZlcmlmaWNhdGlvblN0YXR1cykgfiBGQy4iY29uZmlybWVkIg0KICAgICkNCg0KZGVmaW5lIGZ1bmN0aW9uIFF1YWxpZmllZFByb2NlZHVyZXModmFsdWUgTGlzdDxGSElSLlByb2NlZHVyZT4pOg0KICB2YWx1ZSBQcm9jZWR1cmUNCiAgICB3aGVyZSAoDQogICAgICAvL3ByZXBhcmF0aW9uIHwgaW4tcHJvZ3Jlc3MgfCBub3QtZG9uZSB8IG9uLWhvbGQgfCBzdG9wcGVkIHwgY29tcGxldGVkIHwgZW50ZXJlZC1pbi1lcnJvciB8IHVua25vd24NCiAgICAgIFByb2NlZHVyZS5zdGF0dXMgfiAnY29tcGxldGVkJw0KICAgICkNCg0KZGVmaW5lIGZ1bmN0aW9uIFF1YWxpZmllZERldmljZVJlcXVlc3RzKHZhbHVlIExpc3Q8RkhJUi5EZXZpY2VSZXF1ZXN0Pik6DQogIHZhbHVlIERldmljZVJlcXVlc3QNCiAgICB3aGVyZSAoDQogICAgICAvL2RyYWZ0IHwgYWN0aXZlIHwgb24taG9sZCB8IHJldm9rZWQgfCBjb21wbGV0ZWQgfCBlbnRlcmVkLWluLWVycm9yIHwgdW5rbm93bg0KICAgICAgRGV2aWNlUmVxdWVzdC5zdGF0dXMgfiAnY29tcGxldGVkJw0KICAgICAgb3IgRGV2aWNlUmVxdWVzdC5zdGF0dXMgfiAnYWN0aXZlJw0KICAgICAgYW5kIERldmljZVJlcXVlc3QuaW50ZW50IH4gJ29yZGVyJw0KICAgICkNCg0KZGVmaW5lIGZ1bmN0aW9uIFF1YWxpZmllZE9ic2VydmF0aW9ucyh2YWx1ZSBMaXN0PEZISVIuT2JzZXJ2YXRpb24+KToNCiAgdmFsdWUgT2JzZXJ2YXRpb24NCgkJd2hlcmUgKA0KICAgICAgLy9yZWdpc3RlcmVkIHwgcHJlbGltaW5hcnkgfCBmaW5hbCB8IGFtZW5kZWQgfCBjb3JyZWN0ZWQgfCBjYW5jZWxsZWQgfCBlbnRlcmVkLWluLWVycm9yIHwgdW5rbm93bg0KICAgICAgT2JzZXJ2YXRpb24uc3RhdHVzIH4gJ2ZpbmFsJw0KCQkJb3IgT2JzZXJ2YXRpb24uc3RhdHVzIH4gJ2FtZW5kZWQnDQoJCQlvciBPYnNlcnZhdGlvbi5zdGF0dXMgfiAnY29ycmVjdGVkJw0KCQkpDQoNCmRlZmluZSBmdW5jdGlvbiBGaW5hbFN1cnZleU9ic2VydmF0aW9ucyh2YWx1ZSBMaXN0PEZISVIuT2JzZXJ2YXRpb24+KToNCiAgdmFsdWUgT2JzZXJ2YXRpb24NCiAgCQl3aGVyZSAoDQogICAgICAvL3JlZ2lzdGVyZWQgfCBwcmVsaW1pbmFyeSB8IGZpbmFsIHwgYW1lbmRlZCB8IGNvcnJlY3RlZCB8IGNhbmNlbGxlZCB8IGVudGVyZWQtaW4tZXJyb3IgfCB1bmtub3duDQogICAgICBPYnNlcnZhdGlvbi5zdGF0dXMgfiAnZmluYWwnDQoJCQlvciBPYnNlcnZhdGlvbi5zdGF0dXMgfiAnYW1lbmRlZCcNCgkJCW9yIE9ic2VydmF0aW9uLnN0YXR1cyB+ICdjb3JyZWN0ZWQnDQogICAgICBhbmQgZXhpc3RzKE9ic2VydmF0aW9uLmNhdGVnb3J5IE9ic2VydmF0aW9uQ2F0ZWdvcnkNCiAgICAgICAgd2hlcmUgKCBPYnNlcnZhdGlvbkNhdGVnb3J5ICkgfiAic3VydmV5IikNCgkJKQ0KDQpkZWZpbmUgZnVuY3Rpb24gTGFib3JhdG9yeU9ic2VydmF0aW9uKHZhbHVlIExpc3Q8RkhJUi5PYnNlcnZhdGlvbj4pOg0KICB2YWx1ZSBPYnNlcnZhdGlvbg0KICAJCXdoZXJlICgNCiAgICAgIC8vcmVnaXN0ZXJlZCB8IHByZWxpbWluYXJ5IHwgZmluYWwgfCBhbWVuZGVkIHwgY29ycmVjdGVkIHwgY2FuY2VsbGVkIHwgZW50ZXJlZC1pbi1lcnJvciB8IHVua25vd24NCiAgICAgIE9ic2VydmF0aW9uLnN0YXR1cyB+ICdmaW5hbCcNCgkJCW9yIE9ic2VydmF0aW9uLnN0YXR1cyB+ICdhbWVuZGVkJw0KCQkJb3IgT2JzZXJ2YXRpb24uc3RhdHVzIH4gJ2NvcnJlY3RlZCcNCiAgICAgIGFuZCBleGlzdHMoT2JzZXJ2YXRpb24uY2F0ZWdvcnkgT2JzZXJ2YXRpb25DYXRlZ29yeQ0KICAgICAgICB3aGVyZSAoIE9ic2VydmF0aW9uQ2F0ZWdvcnkgKSB+ICJsYWJvcmF0b3J5IiBvciAoT2JzZXJ2YXRpb25DYXRlZ29yeSkgaXMgbnVsbCkNCgkJKQ0KICAgIA0KDQpkZWZpbmUgZnVuY3Rpb24gUXVhbGlmaWVkTWVkaWNhdGlvblJlcXVlc3RzKHZhbHVlIExpc3Q8RkhJUi5NZWRpY2F0aW9uUmVxdWVzdD4pOg0KICB2YWx1ZSBNZWRpY2F0aW9uUmVxdWVzdA0KICAgIHdoZXJlICgNCiAgICAgIC8vYWN0aXZlIHwgb24taG9sZCB8IGNhbmNlbGxlZCB8IGNvbXBsZXRlZCB8IGVudGVyZWQtaW4tZXJyb3IgfCBzdG9wcGVkIHwgZHJhZnQgfCB1bmtub3duDQogICAgICAoTWVkaWNhdGlvblJlcXVlc3Quc3RhdHVzIH4gJ2FjdGl2ZScNCiAgICAgICAgb3IgTWVkaWNhdGlvblJlcXVlc3Quc3RhdHVzIH4gJ2NvbXBsZXRlZCcNCiAgICAgICkNCiAgICAgICAgYW5kICgNCiAgICAgICAgICBNZWRpY2F0aW9uUmVxdWVzdC5kb05vdFBlcmZvcm0gaXMgbnVsbA0KICAgICAgICAgIG9yIE1lZGljYXRpb25SZXF1ZXN0LmRvTm90UGVyZm9ybSA9IGZhbHNlDQogICAgICAgICkNCiAgICAgICAgYW5kIE1lZGljYXRpb25SZXF1ZXN0LmludGVudCB+ICdvcmRlcicNCiAgICApDQoNCmRlZmluZSBmdW5jdGlvbiBRdWFsaWZpZWRNZWRpY2F0aW9uU3RhdGVtZW50cyh2YWx1ZSBMaXN0PEZISVIuTWVkaWNhdGlvblN0YXRlbWVudD4pOg0KICB2YWx1ZSBNZWRpY2F0aW9uU3RhdGVtZW50DQogICAgd2hlcmUgKA0KICAgICAgLy8gYWN0aXZlIHwgY29tcGxldGVkIHwgZW50ZXJlZC1pbi1lcnJvciB8IGludGVuZGVkIHwgc3RvcHBlZCB8IG9uLWhvbGQgfCB1bmtub3duIHwgbm90LXRha2VuDQogICAgICBNZWRpY2F0aW9uU3RhdGVtZW50LnN0YXR1cyB+ICdhY3RpdmUnDQogICAgICBvciBNZWRpY2F0aW9uU3RhdGVtZW50LnN0YXR1cyB+ICdjb21wbGV0ZWQnDQogICAgKQ0KDQpkZWZpbmUgZnVuY3Rpb24gUXVhbGlmaWVkTWVkaWNhdGlvbkRpc3BlbnNlcyh2YWx1ZSBMaXN0PEZISVIuTWVkaWNhdGlvbkRpc3BlbnNlPik6DQogIHZhbHVlIE1lZGljYXRpb25EaXNwZW5zZQ0KICAgIC8vIHByZXBhcmF0aW9uIHwgaW4tcHJvZ3Jlc3MgfCBjYW5jZWxsZWQgfCBvbi1ob2xkIHwgY29tcGxldGVkIHwgZW50ZXJlZC1pbi1lcnJvciB8IHN0b3BwZWQgfCBkZWNsaW5lZCB8IHVua25vd24NCiAgICB3aGVyZSAoDQogICAgICBNZWRpY2F0aW9uRGlzcGVuc2Uuc3RhdHVzIH4gJ29uLWhvbGQnDQogICAgICBvciBNZWRpY2F0aW9uRGlzcGVuc2Uuc3RhdHVzIH4gJ2luLXByb2dyZXNzJw0KICAgICAgb3IgTWVkaWNhdGlvbkRpc3BlbnNlLnN0YXR1cyB+ICdjb21wbGV0ZWQnDQogICAgKQ0KDQpkZWZpbmUgZnVuY3Rpb24gUXVhbGlmaWVkU2VydmljZVJlcXVlc3RzKHZhbHVlIExpc3Q8RkhJUi5TZXJ2aWNlUmVxdWVzdD4pOg0KICB2YWx1ZSBTZXJ2aWNlUmVxdWVzdA0KICAgIHdoZXJlICgNCiAgICAgIC8vZHJhZnQgfCBhY3RpdmUgfCBvbi1ob2xkIHwgcmV2b2tlZCB8IGNvbXBsZXRlZCB8IGVudGVyZWQtaW4tZXJyb3IgfCB1bmtub3duDQogICAgICBTZXJ2aWNlUmVxdWVzdC5zdGF0dXMgfiAnYWN0aXZlJw0KICAgICAgb3IgU2VydmljZVJlcXVlc3Quc3RhdHVzIH4gJ2NvbXBsZXRlZCcNCiAgICAgIGFuZCBTZXJ2aWNlUmVxdWVzdC5pbnRlbnQgfiAnb3JkZXInDQogICAgKQ0KICAgIGFuZCAoDQogICAgICBTZXJ2aWNlUmVxdWVzdC5kb05vdFBlcmZvcm0gaXMgbnVsbA0KICAgICAgb3IgU2VydmljZVJlcXVlc3QuZG9Ob3RQZXJmb3JtID0gZmFsc2UNCiAgICApDQoNCmRlZmluZSBmdW5jdGlvbiBRdWFsaWZpZWRBbGxlcmd5SW50b2xlcmFuY2VzKHZhbHVlIExpc3Q8RkhJUi5BbGxlcmd5SW50b2xlcmFuY2U+KToNCiAgdmFsdWUgQWxsZXJneUludG9sZXJhbmNlDQogICAgd2hlcmUgKA0KICAgICAgLy9hY3RpdmUgfCBpbmFjdGl2ZSB8IHJlc29sdmVkDQogICAgICBGSElSSGVscGVycy5Ub0NvbmNlcHQoQWxsZXJneUludG9sZXJhbmNlLmNsaW5pY2FsU3RhdHVzKSB+IEZDLiJhbGxlcmd5LWFjdGl2ZSINCiAgICApDQogICAgYW5kICgNCiAgICAgIC8vdW5jb25maXJtZWQgfCBjb25maXJtZWQgfCByZWZ1dGVkIHwgZW50ZXJlZC1pbi1lcnJvcg0KICAgICAgRkhJUkhlbHBlcnMuVG9Db25jZXB0KEFsbGVyZ3lJbnRvbGVyYW5jZS52ZXJpZmljYXRpb25TdGF0dXMpIH4gRkMuImFsbGVyZ3ktY29uZmlybWVkIg0KICAgICkNCg0KZGVmaW5lIGZ1bmN0aW9uIFF1YWxpZmllZEltbXVuaXphdGlvbnModmFsdWUgTGlzdDxGSElSLkltbXVuaXphdGlvbj4pOg0KICB2YWx1ZSBJbW11bml6YXRpb24NCiAgICB3aGVyZSAoDQogICAgICAvL2NvbXBsZXRlZCB8IGVudGVyZWQtaW4tZXJyb3IgfCBub3QtZG9uZQ0KICAgICAgSW1tdW5pemF0aW9uLnN0YXR1cyB+ICdjb21wbGV0ZWQnDQogICAgKQ0KDQpkZWZpbmUgZnVuY3Rpb24gUXVhbGlmaWVkQ29tbXVuaWNhdGlvbnModmFsdWUgTGlzdDxGSElSLkNvbW11bmljYXRpb24+KToNCiAgdmFsdWUgQ29tbXVuaWNhdGlvbg0KICAgIHdoZXJlICgNCiAgICAgIC8vcHJlcGFyYXRpb24gfCBpbi1wcm9ncmVzcyB8IG5vdC1kb25lIHwgb24taG9sZCB8IHN0b3BwZWQgfCBjb21wbGV0ZWQgfCBlbnRlcmVkLWluLWVycm9yIHwgdW5rbm93bg0KICAgICAgQ29tbXVuaWNhdGlvbi5zdGF0dXMgfiAnY29tcGxldGVkJw0KICAgICkNCg0KZGVmaW5lIGZ1bmN0aW9uIFF1YWxpZmllZE1lZGljYXRpb25zKHZhbHVlIExpc3Q8RkhJUi5NZWRpY2F0aW9uPik6DQogIHZhbHVlIE1lZGljYXRpb24NCiAgICB3aGVyZSAoDQogICAgICAvL2FjdGl2ZSB8IGluYWN0aXZlIHwgZW50ZXJlZC1pbi1lcnJvcg0KICAgICAgTWVkaWNhdGlvbi5zdGF0dXMgfiAnYWN0aXZlJw0KICAgICkNCg0KZGVmaW5lIGZ1bmN0aW9uIFF1YWxpZmllZE1lZGljYXRpb25BZG1pbmlzdHJhdGlvbnModmFsdWUgTGlzdDxGSElSLk1lZGljYXRpb25BZG1pbmlzdHJhdGlvbj4pOg0KICB2YWx1ZSBNZWRpY2F0aW9uQWRtaW5pc3RyYXRpb24NCiAgICB3aGVyZSAoDQogICAgICAvL2luLXByb2dyZXNzIHwgbm90LWRvbmUgfCBvbi1ob2xkIHwgY29tcGxldGVkIHwgZW50ZXJlZC1pbi1lcnJvciB8IHN0b3BwZWQgfCB1bmtub3duDQogICAgICBNZWRpY2F0aW9uQWRtaW5pc3RyYXRpb24uc3RhdHVzIH4gJ2NvbXBsZXRlZCcNCiAgICApDQoNCmRlZmluZSBmdW5jdGlvbiBRdWFsaWZpZWRMb2NhdGlvbnModmFsdWUgTGlzdDxGSElSLkxvY2F0aW9uPik6DQogIHZhbHVlIExvY2F0aW9uDQogICAgd2hlcmUgKA0KICAgICAgLy9hY3RpdmUgfCBzdXNwZW5kZWQgfCBpbmFjdGl2ZQ0KICAgICAgTG9jYXRpb24uc3RhdHVzIH4gJ2FjdGl2ZScNCiAgICApDQoNCmRlZmluZSBmdW5jdGlvbiBOb3REb25lT2JzZXJ2YXRpb25zKHZhbHVlIExpc3Q8RkhJUi5PYnNlcnZhdGlvbj4pOg0KICB2YWx1ZSBPYnNlcnZhdGlvbg0KICAgIHdoZXJlICgNCiAgICAgIC8vcmVnaXN0ZXJlZCB8IHByZWxpbWluYXJ5IHwgZmluYWwgfCBhbWVuZGVkIHwgY29ycmVjdGVkIHwgY2FuY2VsbGVkIHwgZW50ZXJlZC1pbi1lcnJvciB8IHVua25vd24NCiAgICAgIE9ic2VydmF0aW9uLnN0YXR1cyB+ICdmaW5hbCcNCiAgICApDQogICAgYW5kICgNCiAgICAgIFJlc291cmNlTm90RG9uZShPYnNlcnZhdGlvbikudmFsdWUgYXMgRkhJUi5ib29sZWFuID0gdHJ1ZQ0KICAgICkNCg0KZGVmaW5lIGZ1bmN0aW9uIE5vdFJlcXVlc3RlZFNlcnZpY2VSZXF1ZXN0cyh2YWx1ZSBMaXN0PEZISVIuU2VydmljZVJlcXVlc3Q+KToNCiAgdmFsdWUgU2VydmljZVJlcXVlc3QNCiAgICB3aGVyZSAoDQogICAgICAvL2RyYWZ0IHwgYWN0aXZlIHwgb24taG9sZCB8IHJldm9rZWQgfCBjb21wbGV0ZWQgfCBlbnRlcmVkLWluLWVycm9yIHwgdW5rbm93bg0KICAgICAgU2VydmljZVJlcXVlc3Quc3RhdHVzIH4gJ2NvbXBsZXRlZCcNCiAgICApDQogICAgYW5kICgNCiAgICAgIFNlcnZpY2VSZXF1ZXN0LmRvTm90UGVyZm9ybSA9IHRydWUNCiAgICApDQoNCmRlZmluZSBmdW5jdGlvbiBOb3RSZXF1ZXN0ZWRNZWRpY2F0aW9uUmVxdWVzdHModmFsdWUgTGlzdDxGSElSLk1lZGljYXRpb25SZXF1ZXN0Pik6DQogIHZhbHVlIE1lZGljYXRpb25SZXF1ZXN0DQogICAgd2hlcmUgKA0KICAgICAgLy9hY3RpdmUgfCBvbi1ob2xkIHwgY2FuY2VsbGVkIHwgY29tcGxldGVkIHwgZW50ZXJlZC1pbi1lcnJvciB8IHN0b3BwZWQgfCBkcmFmdCB8IHVua25vd24NCiAgICAgIE1lZGljYXRpb25SZXF1ZXN0LnN0YXR1cyB+ICdjb21wbGV0ZWQnDQogICAgICBhbmQgTWVkaWNhdGlvblJlcXVlc3QuZG9Ob3RQZXJmb3JtID0gdHJ1ZQ0KICAgICkNCg0KZGVmaW5lIGZ1bmN0aW9uIE5vdERvbmVQcm9jZWR1cmVzKHZhbHVlIExpc3Q8RkhJUi5Qcm9jZWR1cmU+KToNCiAgdmFsdWUgUHJvY2VkdXJlDQogICAgd2hlcmUgKA0KICAgICAgLy9wcmVwYXJhdGlvbiB8IGluLXByb2dyZXNzIHwgbm90LWRvbmUgfCBvbi1ob2xkIHwgc3RvcHBlZCB8IGNvbXBsZXRlZCB8IGVudGVyZWQtaW4tZXJyb3IgfCB1bmtub3duDQogICAgICBQcm9jZWR1cmUuc3RhdHVzIH4gJ25vdC1kb25lJw0KICAgICkNCg0KZGVmaW5lIGZ1bmN0aW9uIE5vdERvbmVNZWRpY2F0aW9uQWRtaW5pc3RyYXRpb25zKHZhbHVlIExpc3Q8RkhJUi5NZWRpY2F0aW9uQWRtaW5pc3RyYXRpb24+KToNCiAgdmFsdWUgTWVkaWNhdGlvbkFkbWluaXN0cmF0aW9uDQogICAgd2hlcmUgKA0KICAgICAgLy9pbi1wcm9ncmVzcyB8IG5vdC1kb25lIHwgb24taG9sZCB8IGNvbXBsZXRlZCB8IGVudGVyZWQtaW4tZXJyb3IgfCBzdG9wcGVkIHwgdW5rbm93bg0KICAgICAgTWVkaWNhdGlvbkFkbWluaXN0cmF0aW9uLnN0YXR1cyB+ICdub3QtZG9uZScNCiAgICApDQo=",
    "url": "http://fhir.org/guides/cqf/aphl/chronic-ds/Library-AlphoraCommon.cql"
  } ]
}