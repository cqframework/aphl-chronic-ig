{
  "resourceType": "PlanDefinition",
  "id": "ChronicDSDepressionScreeningandFollowUp",
  "contained": [ {
    "resourceType": "Library",
    "id": "effective-data-requirements",
    "name": "EffectiveDataRequirements",
    "status": "active",
    "type": {
      "coding": [ {
        "system": "http://terminology.hl7.org/CodeSystem/library-type",
        "code": "module-definition"
      } ]
    },
    "relatedArtifact": [ {
      "type": "depends-on",
      "display": "FHIR model information",
      "resource": "http://fhir.org/guides/cqf/common/Library/FHIR-ModelInfo|4.0.1"
    } ]
  } ],
  "extension": [ {
    "id": "effective-data-requirements",
    "url": "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-effectiveDataRequirements",
    "valueCanonical": "#effective-data-requirements"
  }, {
    "url": "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-softwaresystem",
    "valueReference": {
      "reference": "Device/cqf-tooling"
    }
  } ],
  "url": "http://fhir.org/guides/cqf/aphl/chronic-ds/PlanDefinition/ChronicDSDepressionScreeningandFollowUp",
  "name": "ChronicDSDepressionScreeningandFollowUp",
  "title": "Chronic Disease Surveillance Reporting Specification for Preventive Care and Screening: Screening for Depression and Follow-Up Plan",
  "type": {
    "coding": [ {
      "system": "http://terminology.hl7.org/CodeSystem/plan-definition-type",
      "code": "workflow-definition",
      "display": "Workflow Definition"
    } ],
    "text": "Workflow Definition"
  },
  "status": "active",
  "experimental": true,
  "date": "2025-09-25",
  "description": "Reporting specification for Chronic Disease Surveillance for Preventive Care and Screening: Screening for Depression and Follow-Up Plan",
  "jurisdiction": [ {
    "coding": [ {
      "system": "urn:iso:std:iso:3166",
      "code": "US",
      "display": "United States of America"
    } ],
    "text": "United States of America"
  } ],
  "effectivePeriod": {
    "start": "2024-01-01"
  },
  "library": [ "http://fhir.org/guides/cqf/aphl/chronic-ds/Library/DepressionScreeningandFollowUp" ],
  "action": [ {
    "id": "start",
    "description": "This action represents the start of the reporting workflow in response to the encounter-end event",
    "textEquivalent": "Start the reporting workflow in response to an encounter-end event",
    "code": [ {
      "coding": [ {
        "system": "http://hl7.org/fhir/us/medmorph/CodeSystem/us-ph-plandefinition-actions",
        "code": "initiate-reporting-workflow"
      } ]
    } ],
    "trigger": [ {
      "id": "encounter-close",
      "extension": [ {
        "url": "http://hl7.org/fhir/us/ecr/StructureDefinition/us-ph-named-eventtype-extension",
        "valueCodeableConcept": {
          "coding": [ {
            "system": "http://hl7.org/fhir/us/ecr/CodeSystem/us-ph-triggerdefinition-namedevents",
            "code": "encounter-close",
            "display": "Indicates the closure of an encounter, where in encounter.period.high is populated with the end time."
          } ]
        }
      } ],
      "type": "named-event",
      "name": "encounter-close"
    } ],
    "relatedAction": [ {
      "actionId": "check-reportable",
      "relationship": "before-start",
      "offsetDuration": {
        "value": 24,
        "system": "http://unitsofmeasure.org",
        "code": "h"
      }
    } ]
  }, {
    "id": "check-reportable",
    "description": "This action represents the check for reportability of the surveillance event.",
    "textEquivalent": "Check Reportable",
    "code": [ {
      "coding": [ {
        "system": "http://hl7.org/fhir/us/medmorph/CodeSystem/us-ph-plandefinition-actions",
        "code": "execute-reporting-workflow"
      } ]
    } ],
    "input": [ {
      "id": "observation",
      "type": "Observation",
      "codeFilter": [ {
        "path": "code",
        "code": [ {
          "system": "http://loinc.org",
          "code": "73831-0",
          "display": "Adolescent Depression Screening Assessment"
        } ]
      } ]
    }, {
      "id": "observation",
      "type": "Observation",
      "codeFilter": [ {
        "path": "code",
        "code": [ {
          "system": "http://loinc.org",
          "code": "73832-8",
          "display": "Adult Depression Screening Assessment"
        } ]
      } ]
    } ],
    "relatedAction": [ {
      "actionId": "evaluate-measure",
      "relationship": "before-start"
    } ],
    "action": [ {
      "id": "ckr-is-encounter-reportable",
      "description": "This action represents the check for reportability to create the patients eICR.",
      "textEquivalent": "Check Trigger Codes based on RCTC Value sets.",
      "code": [ {
        "coding": [ {
          "system": "http://hl7.org/fhir/us/medmorph/CodeSystem/us-ph-plandefinition-actions",
          "code": "check-trigger-codes"
        } ]
      } ],
      "condition": [ {
        "kind": "applicability",
        "expression": {
          "language": "text/fhirpath",
          "expression": "%observation.exists()"
        }
      } ],
      "relatedAction": [ {
        "actionId": "evaluate-measure",
        "relationship": "before-start"
      } ]
    } ]
  }, {
    "id": "evaluate-measure",
    "description": "This action represents the evaluation of the measure.",
    "textEquivalent": "Evaluate measure",
    "code": [ {
      "coding": [ {
        "system": "http://hl7.org/fhir/us/medmorph/CodeSystem/us-ph-plandefinition-actions",
        "code": "evaluate-measure"
      } ]
    } ],
    "input": [ {
      "id": "patient",
      "type": "Patient",
      "profile": [ "http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient" ]
    }, {
      "id": "conditions",
      "type": "Condition",
      "profile": [ "http://hl7.org/fhir/us/core/StructureDefinition/us-core-condition" ]
    }, {
      "id": "encounter",
      "type": "Encounter",
      "profile": [ "http://hl7.org/fhir/us/core/StructureDefinition/us-core-encounter" ]
    }, {
      "id": "mr",
      "type": "MedicationRequest",
      "profile": [ "http://hl7.org/fhir/us/core/StructureDefinition/us-core-medicationrequest" ]
    }, {
      "id": "obs",
      "type": "Observation",
      "profile": [ "http://hl7.org/fhir/us/core/StructureDefinition/us-core-simple-observation" ]
    } ],
    "output": [ {
      "id": "measurereport",
      "type": "MeasureReport",
      "profile": [ "http://hl7.org/fhir/MeasureReport" ]
    } ],
    "relatedAction": [ {
      "actionId": "report-ds",
      "relationship": "before-start"
    } ],
    "definitionCanonical": "http://fhir.org/guides/cqf/aphl/chronic-ds/Measure/DepressionScreeningandFollowUp"
  }, {
    "id": "report-ds",
    "description": "This action represents the reporting of the Chronic Disease Surveillance event.",
    "textEquivalent": "Report Chronic Disease Surveillance",
    "code": [ {
      "coding": [ {
        "system": "http://hl7.org/fhir/us/medmorph/CodeSystem/us-ph-plandefinition-actions",
        "code": "execute-reporting-workflow"
      } ]
    } ],
    "condition": [ {
      "kind": "applicability",
      "expression": {
        "language": "text/fhirpath",
        "expression": "%measurereport.exists() and %measurereport.group.select(population).where(code.coding.code = 'denominator' and count > 0).exists()"
      }
    } ],
    "action": [ {
      "action": [ {
        "id": "create-eicr",
        "description": "This action invokes the creation of the eICR report.",
        "textEquivalent": "Create eICR",
        "code": [ {
          "coding": [ {
            "system": "http://hl7.org/fhir/us/medmorph/CodeSystem/us-ph-plandefinition-actions",
            "code": "create-report"
          } ]
        } ],
        "input": [ {
          "id": "patient",
          "type": "Patient",
          "profile": [ "http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient" ]
        }, {
          "id": "conditions",
          "type": "Condition",
          "profile": [ "http://hl7.org/fhir/us/core/StructureDefinition/us-core-condition" ]
        }, {
          "id": "encounter",
          "type": "Encounter",
          "profile": [ "http://hl7.org/fhir/us/core/StructureDefinition/us-core-encounter" ]
        }, {
          "id": "mr",
          "type": "MedicationRequest",
          "profile": [ "http://hl7.org/fhir/us/core/StructureDefinition/us-core-medicationrequest" ]
        }, {
          "id": "obs",
          "type": "Observation",
          "profile": [ "http://hl7.org/fhir/us/core/StructureDefinition/us-core-simple-observation" ]
        }, {
          "id": "generatedmeasurereport",
          "extension": [ {
            "url": "http://hl7.org/fhir/us/ecr/StructureDefinition/us-ph-relateddata-extension",
            "valueString": "measurereport"
          } ],
          "type": "MeasureReport",
          "profile": [ "http://hl7.org/fhir/MeasureReport" ]
        } ],
        "output": [ {
          "id": "eicrbundle",
          "type": "Bundle",
          "profile": [ "http://hl7.org/fhir/us/ecr/StructureDefinition/eicr-measurereport-bundle" ]
        } ],
        "relatedAction": [ {
          "actionId": "validate-eicr",
          "relationship": "before-start"
        } ]
      } ]
    }, {
      "id": "validate-eicr",
      "description": "This action represents the validation of the eICR.",
      "textEquivalent": "Validate eICR",
      "code": [ {
        "coding": [ {
          "system": "http://hl7.org/fhir/us/medmorph/CodeSystem/us-ph-plandefinition-actions",
          "code": "validate-report"
        } ]
      } ],
      "input": [ {
        "id": "createdeicrbundle",
        "extension": [ {
          "url": "http://hl7.org/fhir/us/ecr/StructureDefinition/us-ph-relateddata-extension",
          "valueString": "eicrbundle"
        } ],
        "type": "Bundle",
        "profile": [ "http://hl7.org/fhir/us/ecr/StructureDefinition/eicr-document-bundle" ]
      } ],
      "output": [ {
        "id": "validated-eicr-bundle",
        "type": "Bundle",
        "profile": [ "http://hl7.org/fhir/us/ecr/StructureDefinition/eicr-document-bundle" ]
      } ],
      "relatedAction": [ {
        "actionId": "submit-eicr",
        "relationship": "before-start"
      } ]
    }, {
      "id": "submit-eicr",
      "description": "This action represents the validation of the eICR.",
      "textEquivalent": "Submit eICR",
      "code": [ {
        "coding": [ {
          "system": "http://hl7.org/fhir/us/medmorph/CodeSystem/us-ph-plandefinition-actions",
          "code": "submit-report"
        } ]
      } ],
      "input": [ {
        "id": "validated-eicr-bundle-input",
        "extension": [ {
          "url": "http://hl7.org/fhir/us/ecr/StructureDefinition/us-ph-relateddata-extension",
          "valueString": "validated-eicr-bundle"
        } ],
        "type": "Bundle",
        "profile": [ "http://hl7.org/fhir/us/ecr/StructureDefinition/eicr-document-bundle" ]
      } ],
      "output": [ {
        "id": "eicr-report-submitted",
        "type": "Bundle",
        "profile": [ "http://hl7.org/fhir/us/ecr/StructureDefinition/eicr-document-bundle" ]
      } ]
    } ]
  } ]
}